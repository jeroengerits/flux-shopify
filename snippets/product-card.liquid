{% comment %}
  Product Card Snippet
  Renders a product card with image, title, type, and price

  Usage: {% render 'product-card', product: product, image_width: 800, image_height: 400 %}

  Parameters:
  - product: The product object
  - image_width: Image width (default: 400)
  - image_height: Image height (default: 400)
  - show_type: Whether to show product type (default: true)
  - show_price: Whether to show price (default: true)
{% endcomment %}

{% assign image_width = image_width | default: 400 %}
{% assign image_height = image_height | default: 400 %}
{% assign show_type = show_type | default: true %}
{% assign show_price = show_price | default: true %}

<article class='group'>
  <a
    href='{{ product.url }}'
    class='border-brand-neutral-200 hover:border-brand-neutral-300 focus-visible:ring-brand-accent block overflow-hidden rounded-xl border bg-white transition-all duration-300 hover:shadow-lg focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2'
    aria-label='{{ product.title | escape }}'
  >
    <!-- Product Image Container -->
    <div class='bg-brand-neutral-50 relative aspect-square overflow-hidden'>
      {% if product.featured_image %}
        <img
          src='{{ product.featured_image | image_url: width: image_width, height: image_height, crop: 'center' }}'
          srcset='
            {{ product.featured_image | image_url: width: image_width, height: image_height, crop: 'center' }} 1x,
            {{ product.featured_image | image_url: width: image_width | times: 2, height: image_height | times: 2, crop: 'center' }} 2x
          '
          width='{{ image_width }}'
          height='{{ image_height }}'
          alt='{{ product.featured_image.alt | default: product.title | escape }}'
          loading='lazy'
          decoding='async'
          class='h-full w-full object-cover transition-transform duration-300 group-hover:scale-105'
        >

        <!-- Image Overlay on Hover -->
        <div class='absolute inset-0 bg-black/0 transition-colors duration-300 group-hover:bg-black/10'></div>
      {% else %}
        <!-- Placeholder when no image -->
        <div class='text-brand-neutral-300 flex h-full w-full items-center justify-center'>
          <svg width='64' height='64' fill='none' stroke='currentColor' viewBox='0 0 24 24' aria-hidden='true'>
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
            ></path>
          </svg>
        </div>
      {% endif %}
    </div>

    <!-- Product Information -->
    <div class='p-4'>
      <div class='space-y-2'>
        <!-- Title and Type Row -->
        <div class='flex flex-col gap-1'>
          {% render 'item-title',
            text: product.title,
            class: 'group-hover:text-brand-accent line-clamp-2 transition-colors duration-200'
          %}

          {% if show_type and product.type %}
            {% render 'item-subtitle', text: product.type %}
          {% endif %}
        </div>

        <!-- Price Row -->
        {% if show_price %}
          <div class='flex items-center justify-between'>
            <div class='flex items-center gap-2'>
              {% if product.compare_at_price > product.price %}
                {% render 'item-price',
                  amount: product.compare_at_price,
                  size: 'sm',
                  color: 'muted',
                  class: 'line-through'
                %}
                {% render 'item-price', amount: product.price, size: 'lg', weight: 'semibold', color: 'primary' %}
              {% else %}
                {% render 'item-price', amount: product.price, size: 'lg', weight: 'semibold', color: 'muted' %}
              {% endif %}
            </div>

            <!-- Availability Badge -->
            {% unless product.available %}
              {% render 'tag', text: 'Out of Stock', variant: 'pill', size: 'sm', color: 'error' %}
            {% endunless %}
          </div>
        {% endif %}
      </div>
    </div>
  </a>
</article>
